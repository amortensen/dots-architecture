<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Distributed-Denial-of-Service (DDoS) Open Threat Signaling Architecture</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Context and Motivation"/>
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology"/>
<link href="#rfc.section.1.1.1" rel="Chapter" title="1.1.1 Key Words"/>
<link href="#rfc.section.1.1.2" rel="Chapter" title="1.1.2 Definition of Terms"/>
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Scope"/>
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Assumptions"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Architecture"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 DOTS Operations"/>
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 DOTS Agent Relationships"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Components"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 DOTS client"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 DOTS server"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Concepts"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Signaling Sessions"/>
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 Preconditions"/>
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 Establishing the Signaling Session"/>
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 Maintaining the Signaling Session"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Modes of Signaling"/>
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Direct Signaling"/>
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 Relayed Signaling"/>
<link href="#rfc.section.4.2.3" rel="Chapter" title="4.2.3 Redirected Signaling"/>
<link href="#rfc.section.4.2.4" rel="Chapter" title="4.2.4 Recursive Signaling"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Security Considerations"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Change Log"/>
<link href="#rfc.references" rel="Chapter" title="7 References"/>
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Mortensen, A., Andreasen, F., Reddy, T., Gray, C., Compton, R., and N. Teague" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-mortensen-dots-architecture-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2016-3-18" />
  <meta name="dct.abstract" content="This document describes an architecture for establishing and maintaining Distributed Denial of Service (DDoS) Open Threat Signaling (DOTS) within and between networks. The document makes no attempt to suggest protocols or protocol extensions, instead focusing on architectural relationships, components and concepts used in a DOTS deployment." />
  <meta name="description" content="This document describes an architecture for establishing and maintaining Distributed Denial of Service (DDoS) Open Threat Signaling (DOTS) within and between networks. The document makes no attempt to suggest protocols or protocol extensions, instead focusing on architectural relationships, components and concepts used in a DOTS deployment." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">DOTS</td>
  <td class="right">A. Mortensen</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">Arbor Networks, Inc.</td>
</tr>
<tr>
  <td class="left">Intended status: Informational</td>
  <td class="right">F. Andreasen</td>
</tr>
<tr>
  <td class="left">Expires: September 19, 2016</td>
  <td class="right">T. Reddy</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Cisco Systems, Inc.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">C. Gray</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Comcast, Inc.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">R. Compton</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Charter Communications, Inc.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">N. Teague</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Verisign, Inc.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">March 18, 2016</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Distributed-Denial-of-Service (DDoS) Open Threat Signaling Architecture<br />
  <span class="filename">draft-mortensen-dots-architecture-00</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>This document describes an architecture for establishing and maintaining Distributed Denial of Service (DDoS) Open Threat Signaling (DOTS) within and between networks. The document makes no attempt to suggest protocols or protocol extensions, instead focusing on architectural relationships, components and concepts used in a DOTS deployment.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 19, 2016.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2016 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Context and Motivation</a></li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Terminology</a></li>
<ul><li>1.1.1.   <a href="#rfc.section.1.1.1">Key Words</a></li>
<li>1.1.2.   <a href="#rfc.section.1.1.2">Definition of Terms</a></li>
</ul><li>1.2.   <a href="#rfc.section.1.2">Scope</a></li>
<li>1.3.   <a href="#rfc.section.1.3">Assumptions</a></li>
</ul><li>2.   <a href="#rfc.section.2">Architecture</a></li>
<ul><li>2.1.   <a href="#rfc.section.2.1">DOTS Operations</a></li>
<li>2.2.   <a href="#rfc.section.2.2">DOTS Agent Relationships</a></li>
</ul><li>3.   <a href="#rfc.section.3">Components</a></li>
<ul><li>3.1.   <a href="#rfc.section.3.1">DOTS client</a></li>
<li>3.2.   <a href="#rfc.section.3.2">DOTS server</a></li>
</ul><li>4.   <a href="#rfc.section.4">Concepts</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Signaling Sessions</a></li>
<ul><li>4.1.1.   <a href="#rfc.section.4.1.1">Preconditions</a></li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">Establishing the Signaling Session</a></li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">Maintaining the Signaling Session</a></li>
</ul><li>4.2.   <a href="#rfc.section.4.2">Modes of Signaling</a></li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">Direct Signaling</a></li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">Relayed Signaling</a></li>
<li>4.2.3.   <a href="#rfc.section.4.2.3">Redirected Signaling</a></li>
<li>4.2.4.   <a href="#rfc.section.4.2.4">Recursive Signaling</a></li>
</ul></ul><li>5.   <a href="#rfc.section.5">Security Considerations</a></li>
<li>6.   <a href="#rfc.section.6">Change Log</a></li>
<li>7.   <a href="#rfc.references">References</a></li>
<ul><li>7.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#context-and-motivation" id="context-and-motivation">Context and Motivation</a></h1>
<p id="rfc.section.1.p.1">Signaling the need for help defending against an active distributed denial of service (DDoS) attack requires a common understanding of mechanisms and roles among the parties coordinating attack response. The proposed signaling layer and supplementary messaging is the focus of DDoS Open Threat Signaling (DOTS). DOTS proposes to standardize a method of coordinating defensive measures among willing peers to mitigate attacks quickly and efficiently.</p>
<p id="rfc.section.1.p.2">This document describes an architecture used in establishing, maintaining or terminating a DOTS relationship in a network or between networks. DOTS enables hybrid attack responses, coordinated locally at or near the target of an active attack, as well as closer to attack sources in the network path.</p>
<h2 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a></h2>
<h3 id="rfc.section.1.1.1"><a href="#rfc.section.1.1.1">1.1.1.</a> <a href="#key-words" id="key-words">Key Words</a></h3>
<p id="rfc.section.1.1.1.p.1">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h3 id="rfc.section.1.1.2"><a href="#rfc.section.1.1.2">1.1.2.</a> <a href="#definition-of-terms" id="definition-of-terms">Definition of Terms</a></h3>
<p id="rfc.section.1.1.2.p.1">This document uses the terms defined in <a href="#I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</a>.</p>
<h2 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> <a href="#scope" id="scope">Scope</a></h2>
<p id="rfc.section.1.2.p.1">This document defines an architecture for the proposed DOTS standard in the IETF.</p>
<p id="rfc.section.1.2.p.2">In this architecture, DOTS clients and servers communicate using the signaling mechanism established in the proposed DOTS standard. As a result of signals from a DOTS client, the DOTS server may modify the network path of traffic destined for the attack target or targets, for example by diverting traffic to a scrubbing center. Packets deemed part of an active attack may be dropped.</p>
<p id="rfc.section.1.2.p.3">The architecture presented here is assumed to be applicable across network administrative domains &#8211; for example, between an enterprise domain and the domain of a third-party attack scrubbing service &#8211; as well as to a single administrative domain. DOTS is generally assumed to be most effective when aiding coordination of attack response between two or more participating network domains, but single domain scenarios are valuable in their own right, as when aggregating intra-domain DOTS client signals for inter-domain coordinated attack response.</p>
<h2 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a> <a href="#assumptions" id="assumptions">Assumptions</a></h2>
<p id="rfc.section.1.3.p.1">This document makes the following assumptions:</p>
<p/>

<ul>
  <li>The network or networks in which DOTS is deployed are assumed to offer the required connectivity between DOTS agents and any intermediary network elements, but the architecture imposes no additional limitations on the form of connectivity.</li>
  <li>Congestion and resource exhaustion are intended outcomes of a DDoS attack <a href="#RFC4732">[RFC4732]</a>. Some operators may utilize non-impacted paths or networks for DOTS, however, it should be assumed that, in general, conditions will be hostile and that DOTS must be able to function in all circumstances, including when the signaling path is significantly impaired.</li>
  <li>There is no universal DDoS attack scale threshold triggering a coordinated response across network administrative domains. A network domain administrator, or service or application owner may arbitrarily set attack scale threshold triggers, or manually send requests for mitigation.</li>
  <li>The mitigation capacity and/or capability of networks receiving requests for coordinated attack response is opaque to the network sending the request. The entity receiving the DOTS client signal may or may not have sufficient capacity or capability to filter any or all DDoS attack traffic directed at a target.</li>
  <li>DOTS client and server signals, as well as messages sent through the data channel, are sent across any transit networks with the same probability of delivery as any other traffic between the DOTS client network and the DOTS server network. Any encapsulation required for successful delivery is left untouched by transit network elements. DOTS server and DOTS client cannot assume any preferential treatment of DOTS signals.</li>
  <li>The architecture allows for, but does not assume, the presence of Quality of Service (QoS) policy agreements between DOTS-enabled peer networks or local QoS prioritization aimed at ensuring delivery of DOTS messages between DOTS agents. QoS is an operational consideration only, not a functional part of a DOTS architecture.</li>
  <li>There is no assumption that the signal channel and the data channel should terminate on the same DOTS server: they may be loosely coupled.</li>
</ul>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#architecture" id="architecture">Architecture</a></h1>
<p id="rfc.section.2.p.1">DOTS enables a target that is under a Distributed Denial-of-Service (DDoS) attack to signal another entity for help in mitigating the DDoS attack. The basic high-level DOTS architecture is illustrated in <a href="#fig-basic-arch">Figure 1</a>:</p>
<div id="rfc.figure.1"/>
<div id="fig-basic-arch"/>
<pre>
    +-----------+            +-------------+
    | Mitigator | ~~~~~~~~~~ | DOTS Server |
    +-----------+            +-------------+
                               |         |
                               |         |
                               |         |
                               |    +------------+
                               |    | DOTS Relay |
                               |    +------------+
                               |         |
                               |         |
                               |         |
   +---------------+         +-------------+
   | Attack Target | ~~~~~~~ | DOTS Client |
   +---------------+         +-------------+
</pre>
<p class="figure">Figure 1: Basic DOTS Architecture</p>
<p id="rfc.section.2.p.2">A simple example instantiation of the DOTS architecture could be an enterprise as the attack target for a volumetric DDoS attack, and an upstream DDoS mitigation service as the Mitigator. The enterprise (attack target) is connected to the Internet via a link that is getting saturated, and the enterprise suspects it is under DDoS attack. The enterprise has a DOTS client, which obtains information about the DDoS attack, and signals the DOTS server for help in mitigating the attack. The communication may be direct from the DOTS client to the DOTS Server, or it may traverse one or more DOTS Relays, which act as intermediaries. The DOTS Server in turn invokes one or more mitigators, which are tasked with mitigating the actual DDoS attack, and hence aim to suppress the attack traffic while allowing valid traffic to reach the attack target.</p>
<p id="rfc.section.2.p.3">The scope of the DOTS specifications is the interfaces between the DOTS client, DOTS server, and DOTS relay. The interfaces to the attack target and the mitigator are out of scope of DOTS. Similarly, the operation of both the attack target and the mitigator are out of scope of DOTS. Thus, DOTS neither specifies how an attack target decides it is under DDoS attack, nor does DOTS specify how a mitigator may actually mitigate such an attack. Indeed, a DOTS client&#8217;s request for mitigation is advisory in nature, and may not lead to any mitigation at all, depending on the DOTS server entity&#8217;s capacity and willingness to mitigate on behalf of the DOTS client&#8217;s entity.</p>
<p id="rfc.section.2.p.4">As illustrated in <a href="#fig-interfaces">Figure 2</a>, there are two interfaces between the DOTS Server and the DOTS Client (and possibly the DOTS Relay):</p>
<div id="rfc.figure.2"/>
<div id="fig-interfaces"/>
<pre>
    +---------------+                                 +---------------+
    |               | &lt;------- Signal Channel ------&gt; |               |
    |  DOTS Client  |                                 |  DOTS Server  |
    |               | &lt;=======  Data Channel  ======&gt; |               |
    +---------------+                                 +---------------+
</pre>
<p class="figure">Figure 2: DOTS Interfaces</p>
<p id="rfc.section.2.p.5">The primary purpose of the signal channel is for the DOTS client to ask the DOTS server for help in mitigating an attack, and for the DOTS server to inform the DOTS client about the status of such mitigation. The DOTS client does this by sending a client signal, which contains information about the attack target or targets.  The client signal may also include telemetry information about the attack, if the DOTS client has such information available. The DOTS Server in turn sends a server signal to inform the DOTS client of whether it will honor the mitigation request. Assuming it will, the DOTS Server initiates attack mitigation (by means outside of DOTS), and periodically informs the DOTS client about the status of the mitigation.  Similarly, the DOTS client periodically informs the DOTS server about the client&#8217;s status, which at a minimum provides client (attack target) health information, but it may also include telemetry information about the attack as it is now seen by the client. At some point, the DOTS client may decide to terminate the server-side attack mitigation, which it indicates to the DOTS server over the signal channel. A mitigation may also be terminated if a DOTS client-specified mitigation time limit is exceeded; additional considerations around mitigation time limits may be found below. Note that the signal channel may need to operate over a link that is experiencing a DDoS attack and hence is subject to severe packet loss and high latency.</p>
<p id="rfc.section.2.p.6">While DOTS is able to request mitigation with just the signal channel, the addition of the DOTS data channel provides for additional and more efficient capabilities.  The primary purpose of the data channel is to support DOTS related configuration and policy information exchange between the DOTS client and the DOTS server. Examples of such information include</p>
<p/>

<ul>
  <li>Defining names or aliases for attack targets (resources). Those names can be used in subsequent signal channel exchanges to more efficiently refer to the resources (attack targets) in question.</li>
  <li>Black-list management, which enables a DOTS client to inform the DOTS server about sources to suppress.</li>
  <li>White-list management, which enables a DOTS client to inform the DOTS server about sources from which traffic should always be accepted.</li>
  <li>DOTS client provisioning.</li>
  <li>Vendor-specific extensions, supplementing or in some other way facilitating mitigation when the mitigator relies on particular proprietary interfaces.</li>
</ul>
<p id="rfc.section.2.p.8">Note that while it is possible to exchange the above information before, during or after a DDoS attack, DOTS requires reliable delivery of the above information and does not provide any special means for ensuring timely delivery of it during an attack. In practice, this means that DOTS entities SHOULD NOT rely on such information being exchanged during a DDoS attack.</p>
<h2 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> <a href="#operations" id="operations">DOTS Operations</a></h2>
<p id="rfc.section.2.1.p.1">The scope of DOTS is focused on the signaling and data exchange between the DOTS client, DOTS server and (possibly) the DOTS relay. DOTS does not prescribe any specific deployment models, however DOTS is designed with some specific requirements around the different DOTS agents and their relationships.</p>
<p id="rfc.section.2.1.p.2">First of all, a DOTS agent belongs to an entity, and that entity has an identity which can be authenticated. DOTS agents communicate with each other over a mutually authenticated signal channel and bulk data channel. However, before they can do so, a service relationship needs to be established between them.  The details and means by which this is done is outside the scope of DOTS, however an example would be for an enterprise A (DOTS client) to sign up for DDoS service from provider B (DOTS server). This would establish a (service) relationship between the two that enables enterprise A&#8217;s DOTS client to establish a signal channel with provider B&#8217;s DOTS server. A and B will authenticate each other, and B can verify that A is authorized for its service.  A and B may each have one or more DOTS relays in front of their DOTS client and DOTS server.</p>
<p id="rfc.section.2.1.p.3">[[EDITOR&#8217;S NOTE: we request working group feedback and discussion of considerations of end-to-end signaling and agent authentication/authorization with relays in the signaling path.]]</p>
<p id="rfc.section.2.1.p.4">From an operational and design point of view, DOTS assumes that the above relationship is established prior to a request for DDoS attack mitigation. In particular, it is assumed that bi-directional communication is possible at this time between the DOTS client and DOTS server. Furthermore, it as assumed that additional service provisioning, configuration and information exchange can be performed by use of the data channel, if operationally required, as in the case where vendor-specific extensions are in use. It is not until this point that the mitigation service is available for use.</p>
<p id="rfc.section.2.1.p.5">Once the mutually authenticated signal channel has been established, it will remain in place. This is done to increase the likelihood that the DOTS client can signal the DOTS server for help when the attack target is being flooded, and similarly raise the probability that DOTS server signals reach the client regardless of inbound link congestion.  This does not necessarily imply that the attack target and the DOTS client have to be co-located in the same administrative domain, but it is expected to be a common scenario.</p>
<p id="rfc.section.2.1.p.6">DDoS mitigation service with the help of an upstream mitigator will often involve some form of traffic redirection whereby traffic destined for the attack target is diverted towards the mitigator, e.g. by use of BGP <a href="#RFC4271">[RFC4271]</a> or DNS <a href="#RFC1034">[RFC1034]</a>. The mitigator in turn inspects and scrubs the traffic, and forwards the resulting (hopefully non-attack) traffic to the attack target, e.g. via a GRE tunnel.  Thus, when a DOTS server receives an attack mitigation request from a DOTS client, it can be viewed as a way of causing traffic redirection for the attack target indicated. Note that DOTS does not consider any authorization aspects around who should be allowed to issue such requests for what attack targets.  Instead, DOTS merely relies on the mutual authentication and the pre-established (service) relationship between the entity owning the DOTS client and the entity owning the DOTS server. The entity owning the DOTS server SHOULD limit the attack targets that a particular DOTS client can request mitigation for as part of establishing this relationship. The method of such limitation is not in scope for this document.</p>
<p id="rfc.section.2.1.p.7">Although co-location of DOTS server and mitigator within the same entity is expected to be a common deployment model, it is assumed that operators may require alternative models. Nothing in this document precludes such alternatives.</p>
<h2 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a> <a href="#agent-relationships" id="agent-relationships">DOTS Agent Relationships</a></h2>
<p id="rfc.section.2.2.p.1">So far, we have only considered a relatively simple scenario of a single DOTS client associated with a single DOTS server, however DOTS supports more advanced relationships.</p>
<p id="rfc.section.2.2.p.2">A DOTS server may be associated with one or more DOTS clients, and those DOTS clients may belong to different entities. An example scenario is a mitigation provider serving multiple attack targets (<a href="#fig-multi-client-server">Figure 3</a>):</p>
<div id="rfc.figure.3"/>
<div id="fig-multi-client-server"/>
<pre>
   +---+
   | c |-----------
   +---+           \
                    \
   +---+             \ +---+
   | c |---------------| S |
   +---+             / +---+
                    /
   +---+           /
   | c |-----------
   +---+
   example.com/.org   example.net
   DOTS Clients       DOTS Server
</pre>
<p class="figure">Figure 3: Multiple DOTS clients for a DOTS server</p>
<p id="rfc.section.2.2.p.3">A DOTS client may be associated with one or more DOTS servers, and those DOTS servers may belong to different entities.  This may be to ensure high availability or co-ordinate mitigation with more than one directly connected ISP.  An example scenario is for an enterprise to have DDoS mitigation service from multiple providers, as shown in <a href="#fig-multi-homed-client">Figure 4</a> below.  Operational considerations relating to co-ordinating multiple provider responses are beyond the scope of DOTS.</p>
<p id="rfc.section.2.2.p.4">[[EDITOR&#8217;S NOTE: we request working group feedback and discussion of operational considerations relating to coordinating multiple provider responses to a mitigation request.]]</p>
<div id="rfc.figure.4"/>
<div id="fig-multi-homed-client"/>
<pre>
                       +---+
           ------------| S |
          /            +---+
         /
   +---+/              +---+
   | c |---------------| S |
   +---+\              +---+
         \
          \            +---+
           ------------| S |
                       +---+
   example.com        example.net/.org
   DOTS Client        DOTS Servers
</pre>
<p class="figure">Figure 4: Multi-Homed DOTS Client</p>
<p id="rfc.section.2.2.p.5">DOTS Relays may be either server-side or client-side, or both. A DOTS server-side relay belongs to the entity owning the DOTS server.  A relay will terminate multiple discrete client connections as if it were a server and may aggregate these into a single (<a href="#fig-client-side-relay-agg">Figure 5</a>) or multiple DOTS signaling sessions (<a href="#fig-client-side-relay-no-agg">Figure 6</a>) depending upon locally applied policy.  A relay will function as a server to its downstream clients and as a client to its upstream peers.  Aside from the exceptions discussed in <a href="#relayed-signaling">Section 4.2.2</a> below, The relationship between the relay and its upstream peers is opaque to the relayed clients. An example scenario is for an enterprise to have deployed multiple DOTS capable devices which are able to signal intra-domain using TCP <a href="#RFC0793">[RFC0793]</a> on un-congested links to a relay which may then transform these to a UDP <a href="#RFC0768">[RFC0768]</a> transport inter-domain where connection oriented transports may degrader; this applies to the signal channel only, as the data channel requires a connection-oriented transport.  The relationship between the relay and its upstream peers is opaque to the relayed clients.</p>
<div id="rfc.figure.5"/>
<div id="fig-client-side-relay-agg"/>
<pre>
   +---+
   | c |\
   +---+ \              +---+
          \-----TCP-----| r |              +---+
   +---+                | e |              |   |
   | c |--------TCP-----| l |------UDP-----| S |
   +---+                | a |              |   |
          /-----TCP-----| y |              +---+
   +---+ /              +---+
   | c |/
   +---+
   example.com       example.com         example.net
   DOTS Clients      DOTS Relay          DOTS Server
</pre>
<p class="figure">Figure 5: Client-Side Relay with Aggregation</p>
<div id="rfc.figure.6"/>
<div id="fig-client-side-relay-no-agg"/>
<pre>
   +---+
   | c |\
   +---+ \              +---+
          \-----TCP-----| r |------UDP-----+---+
   +---+                | e |              |   |
   | c |--------TCP-----| l |------UDP-----| S |
   +---+                | a |              |   |
          /-----TCP-----| y |------UDP-----+---+
   +---+ /              +---+
   | c |/
   +---+
   example.com       example.com         example.net
   DOTS Clients      DOTS Relay          DOTS Server
</pre>
<p class="figure">Figure 6: Client-Side Relay without Aggregation</p>
<p id="rfc.section.2.2.p.6">A variation of this scenario would be a DDoS mitigation provider deploying relays at their perimeter to consume signals across multiple transports and to consolidate these into a single transport suitable for the providers deployment, as shown in <a href="#fig-server-side-relay-agg">Figure 7</a> and <a href="#fig-server-side-relay-no-agg">Figure 8</a> below.  The relationship between the relay and its upstream peers is opaque to the relayed clients.</p>
<p id="rfc.section.2.2.p.7">[[EDITOR&#8217;S NOTE: we request working group feedback and discussion of DOTS client visibility into relayed signaling.]]</p>
<div id="rfc.figure.7"/>
<div id="fig-server-side-relay-agg"/>
<pre>
   +---+
   | c |\
   +---+ \              +---+
          \-----UDP-----| r |              +---+
   +---+                | e |              |   |
   | c |--------TCP-----| l |------TCP-----| S |
   +---+                | a |              |   |
          /-----TCP-----| y |              +---+
   +---+ /              +---+
   | c |/
   +---+
   example.com       example.net         example.net
   DOTS Clients      DOTS Relay          DOTS Server
</pre>
<p class="figure">Figure 7: Server-Side Relay with Aggregation</p>
<div id="rfc.figure.8"/>
<div id="fig-server-side-relay-no-agg"/>
<pre>
   +---+
   | c |\
   +---+ \              +---+
          \-----UDP-----| r |------TCP-----+---+
   +---+                | e |              |   |
   | c |--------TCP-----| l |------TCP-----| S |
   +---+                | a |              |   |
          /-----UDP-----| y |------TCP-----+---+
   +---+ /              +---+
   | c |/
   +---+
   example.com       example.net         example.net
   DOTS Clients      DOTS Relay          DOTS Server
</pre>
<p class="figure">Figure 8: Server-Side Relay without Aggregation</p>
<p id="rfc.section.2.2.p.8">In the context of relays, sessions are established directly between peer DOTS agents and may not be end to end.  In spite of this distinction a method must exist to uniquely identify the originating DOTS client. The relay should identify itself as such to any clients or servers it interacts with.  Greater abstraction by way of additional layers of relays may introduce undesired complexity in regard to authentication and authorization and should be avoided.</p>
<p id="rfc.section.2.2.p.9">[[EDITOR&#8217;S NOTE: we request working group feedback and discussion of the many-to-one and one-to-many client/server, client/relay, and relay/server relationships described above. We additional request working group feedback and discussion of end-to-end signaling considerations in the context of relayed signaling.]]</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#components" id="components">Components</a></h1>
<p id="rfc.section.3.p.1">The architecture in this document is comprised of a few basic components on top of the assumed underlay network or networks described above. When connected to one another, the components represent an operational DOTS architecture.</p>
<p id="rfc.section.3.p.2">This section describes the components themselves. <a href="#concepts">Section 4</a> below describes the architectural concepts involved.</p>
<h2 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#dots-client" id="dots-client">DOTS client</a></h2>
<p id="rfc.section.3.1.p.1">A DOTS client is a DOTS agent from which requests for help coordinating attack response originate. The requests may be in response to an active, ongoing attack against a target in the DOTS client&#8217;s domain, but no active attack is required for a DOTS client to request help. Local operators may wish to have upstream traffic scrubbers in the network path for an indefinite period, and are restricted only by business relationships when it comes to duration and scope of requested mitigation.</p>
<p id="rfc.section.3.1.p.2">The DOTS client requests attack response coordination from a DOTS server over the signal channel, including in the request the DOTS client&#8217;s desired mitigation scoping, as described in <a href="#I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</a>. The actual mitigation scope and countermeasures used in response to the attack are up to the DOTS server and Mitgator operators, as the DOTS client may have a narrow perspective on the ongoing attack. As such, the DOTS client&#8217;s request for mitigation should be considered advisory: guarantees of DOTS server availability or mitigation capacity constitute service level agreements and are out of scope for this document.</p>
<p id="rfc.section.3.1.p.3">The DOTS client adjusts mitigation scope and provides available attack details at the direction of its local operator. Such direction may involve manual or automated adjustments in response to feedback from the DOTS server.</p>
<p id="rfc.section.3.1.p.4">To provide a metric of signal health and distinguish an idle signaling session from a disconnected or defunct session, the DOTS client sends a heartbeat over the signal channel to maintain its half of the signaling session. The DOTS client similarly expects a heartbeat from the DOTS server, and MAY consider a signaling session terminated in the extended absence of a DOTS server heartbeat.</p>
<h2 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> <a href="#dots-server" id="dots-server">DOTS server</a></h2>
<p id="rfc.section.3.2.p.1">A DOTS server is a DOTS agent capable of receiving, processing and possibly acting on requests for help coordinating attack response from one or more DOTS clients.  The DOTS server authenticates and authorizes DOTS clients as described in Signaling Sessions below, and maintains signaling session state, tracking requests for mitigation, reporting on the status of active mitigations, and terminating signaling sessions in the extended absence of a client heartbeat or when a session times out.</p>
<p id="rfc.section.3.2.p.2">Assuming the preconditions discussed below exist, a DOTS client maintaining an active signaling session with a DOTS server may reasonably expect some level of mitigation in response to a request for coordinated attack response.</p>
<p id="rfc.section.3.2.p.3">The DOTS server enforces authorization of DOTS clients&#8217; signals for mitigation.  The mechanism of enforcement is not in scope for this document, but is expected to restrict requested mitigation scope to addresses, prefixes, and/or services owned by the DOTS client&#8217;s administrative entity, such that a DOTS client from one entity is not able to influence the network path to another entity. A DOTS server MUST reject requests for mitigation of resources not owned by the requesting DOTS client&#8217;s administrative entity. A DOTS server MAY also refuse a DOTS client&#8217;s mitigation request for arbitrary reasons, within any limits imposed by business or service level agreements between client and server domains. If a DOTS server refuses a DOTS client&#8217;s request for mitigation, the DOTS server SHOULD include the refusal reason in the server signal sent to the client.</p>
<p id="rfc.section.3.2.p.4">A DOTS server is in regular contact with one or more mitigators. If a DOTS server accepts a DOTS client&#8217;s request for help, the DOTS server forwards a translated form of that request to the mitigator or mitigators responsible for scrubbing attack traffic. Note that the form of the translated request passed from the DOTS server to the mitigator is not in scope: it may be as simple as an alert to mitigator operators, or highly automated using vendor or open application programming interfaces supported by the mitigator. The DOTS server MUST report the actual scope of any mitigation enabled on behalf of a client.</p>
<p id="rfc.section.3.2.p.5">The DOTS server SHOULD retrieve available metrics for any mitigations activated on behalf of a DOTS client, and SHOULD include them in server signals sent to the DOTS client originating the request for mitigation.</p>
<p id="rfc.section.3.2.p.6">To provide a metric of signal health and distinguish an idle signaling session from a disconnected or defunct session, the DOTS server sends a heartbeat over the signal channel to maintain its half of the signaling session. The DOTS server similarly expects a heartbeat from the DOTS client, and MAY consider a signaling session terminated in the extended absence of a DOTS client heartbeat.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#concepts" id="concepts">Concepts</a></h1>
<h2 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#signaling-sessions" id="signaling-sessions">Signaling Sessions</a></h2>
<p id="rfc.section.4.1.p.1">In order for DOTS to be effective as a vehicle for DDoS mitigation requests, one or more DOTS clients must establish ongoing communication with one or more DOTS servers. While the preconditions for enabling DOTS in or among network domains may also involve business relationships, service level agreements, or other formal or informal understandings between network operators, such considerations are out of scope for this document.</p>
<p id="rfc.section.4.1.p.2">An established communication layer between DOTS agents is a Signaling Session.  At its most basic, for a DOTS signaling session to exist both signal channel and data channel must be functioning between DOTS agents. That is, under nominal network conditions, signals actively sent from a DOTS client are received by the specific DOTS server intended by the client, and vice versa.</p>
<h3 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#signaling-session-preconditions" id="signaling-session-preconditions">Preconditions</a></h3>
<p id="rfc.section.4.1.1.p.1">Prior to establishing a signaling session between agents, the owners of the networks, domains, services or applications involved are assumed to have agreed upon the terms of the relationship involved. Such agreements are out of scope for this document, but must be in place for a functional DOTS architecture.</p>
<p id="rfc.section.4.1.1.p.2">It is assumed that as part of any DOTS service agreement, the DOTS client is provided with all data and metadata required to establish communication with the DOTS server. Such data and metadata would include any cryptographic information necessary to meet the message confidentiality, integrity and authenticity requirement in <a href="#I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</a>, and might also include the pool of DOTS server addresses and ports the DOTS client should use for signal and data channel messaging.</p>
<h3 id="rfc.section.4.1.2"><a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#establishing-signaling-session" id="establishing-signaling-session">Establishing the Signaling Session</a></h3>
<p id="rfc.section.4.1.2.p.1">With the required business or service agreements in place, the DOTS client initiates a signal session by contacting the DOTS server over the signal channel and the data channel. To allow for DOTS service flexibility, neither the order of contact nor the time interval between channel creations is specified. A DOTS client MAY establish signal channel first, and then data channel, or vice versa.</p>
<p id="rfc.section.4.1.2.p.2">The methods by which a DOTS client receives the address and associated service details of the DOTS server are not prescribed by this document. For example, a DOTS client may be manually configured to use a specific DOTS server address and port, and manually provided with any data necessary to satisfy the Peer Mutual Authentication and Message Confidentiality requirements in <a href="#I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</a>, such as public/private key pairs or symmetric key data, usernames and passwords, or other identifying or cryptographic metadata.</p>
<p id="rfc.section.4.1.2.p.3">At the other extreme, the architecture in this document allows for DOTS client auto-provisioning. In this case, a DOTS client might discover a DOTS server through mechanisms similar to DNS SRV <a href="#RFC2782">[RFC2782]</a> or DNS Service Discovery <a href="#RFC6763">[RFC6763]</a>. In this scenario, the DOTS client, using minimal authenticating information previously provided by the DOTS server&#8217;s entity, contacts the DOTS server over the data channel and retrieves additional service and cryptographic data; and, using that additional data, establishes the signal channel.</p>
<p id="rfc.section.4.1.2.p.4">The DOTS client SHOULD successfully authenticate and exchange messages with the DOTS server over both signal and data channel as soon as possible to confirm the DOTS client has expected access to the DOTS server.</p>
<p id="rfc.section.4.1.2.p.5">Once the DOTS client begins receiving DOTS server signals, the signaling session is active. At any time during the signaling session, the DOTS client MAY use the data channel to adjust initial configuration, manage black- and white-listed prefixes or addresses, leverage vendor-specific extensions, and so on. Note that unlike the signal channel, there is no requirement that the data channel remain operational in attack conditions (See Data Channel Requirements, <a href="#I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</a>).</p>
<h3 id="rfc.section.4.1.3"><a href="#rfc.section.4.1.3">4.1.3.</a> <a href="#maintaining-signaling-session" id="maintaining-signaling-session">Maintaining the Signaling Session</a></h3>
<p id="rfc.section.4.1.3.p.1">DOTS clients, servers and relays periodically send heartbeats to each other over the signal channel, per Operational Requirements discussed in <a href="#I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</a>. DOTS agent operators SHOULD configure the heartbeat interval such that the frequency does not lead to accidental denials of service due to the overwhelming number of heartbeats a DOTS agent must field.</p>
<p id="rfc.section.4.1.3.p.2">Either DOTS agent may consider a signaling session terminated in the extended absence of a heartbeat from its peer agent. The period of that absence will be established in the protocol definition.</p>
<h2 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#modes-of-signaling" id="modes-of-signaling">Modes of Signaling</a></h2>
<p id="rfc.section.4.2.p.1">This section examines the modes of signaling between agents in a DOTS architecture.</p>
<h3 id="rfc.section.4.2.1"><a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#direct-signaling" id="direct-signaling">Direct Signaling</a></h3>
<p id="rfc.section.4.2.1.p.1">A signaling session may take the form of direct signaling between the DOTS clients and servers, as shown in <a href="#fig-direct-signaling">Figure 9</a> below:</p>
<div id="rfc.figure.9"/>
<div id="fig-direct-signaling"/>
<pre>
        +-------------+                            +-------------+
        | DOTS client |&lt;------signal session------&gt;| DOTS server |
        +-------------+                            +-------------+
</pre>
<p class="figure">Figure 9: Direct Signaling</p>
<p id="rfc.section.4.2.1.p.2">In a direct signaling session, DOTS client and server are communicating directly, with no relays in the signaling path. A direct signaling session MAY exist inter- or intra-domain. The signaling session is abstracted from the underlying networks or network elements the signals traverse: in a direct signaling session, the DOTS client and server are logically peer DOTS agents.</p>
<h3 id="rfc.section.4.2.2"><a href="#rfc.section.4.2.2">4.2.2.</a> <a href="#relayed-signaling" id="relayed-signaling">Relayed Signaling</a></h3>
<p id="rfc.section.4.2.2.p.1">A signaling session may also include one or more DOTS relays in the signaling path between the clients and servers, as shown in <a href="#fig-relayed-signaling">Figure 10</a>:</p>
<div id="rfc.figure.10"/>
<div id="fig-relayed-signaling"/>
<pre>
    +-------------+                              +-------------+
    | DOTS client |                              | DOTS server |
    +-------------+                              +-------------+
           ^                                           ^
           |    +------------+       +------------+    |
           +---&gt;| DOTS relay |&lt;-----&gt;| DOTS relay |&lt;---+
                +------------+       +------------+
</pre>
<p class="figure">Figure 10: Relayed Signaling</p>
<p id="rfc.section.4.2.2.p.2">To allow for maximum architectural flexibility, no restriction is placed on the number of relays in the signaling path. Operators of DOTS agents should consider the impact on signal latency incurred by each additional DOTS relay in the signaling path, as well as the increased operational complexity, when deploying DOTS relays.</p>
<p id="rfc.section.4.2.2.p.3">[[EDITOR&#8217;S NOTE: we request working group feedback and discussion of operational considerations related to DOTS relays, particularly with respect to the implications of multiple relays in the signal path.]]</p>
<p id="rfc.section.4.2.2.p.4">As discussed above in <a href="#agent-relationships">Section 2.2</a>, relays may be client-side or server-side. In either case, the relay appears to the peer agent as its logical opposite. That is, if a DOTS relay appears to a DOTS client or downstream relay as a DOTS server. Conversely, a DOTS relay appears to a DOTS server or upstream DOTS relay as a DOTS client. Thus relayed signaling may be thought of as chained direct signaling sessions.</p>
<h3 id="rfc.section.4.2.3"><a href="#rfc.section.4.2.3">4.2.3.</a> <a href="#redirected-signaling" id="redirected-signaling">Redirected Signaling</a></h3>
<p id="rfc.section.4.2.3.p.1">In certain circumstances, a DOTS server may want to redirect a DOTS client to an alternative DOTS server for a signaling session. Such circumstances include but are not limited to:</p>
<p/>

<ul>
  <li>Maximum number of signaling sessions with clients has been reached;</li>
  <li>Mitigation capacity exhaustion in the Mitigator with which the specific DOTS server is communicating;</li>
  <li>Mitigator outage or other downtime, such as scheduled maintenance;</li>
  <li>Scheduled DOTS server maintenance;</li>
  <li>Scheduled modifications to the network path between DOTS server and DOTS client.</li>
</ul>
<p id="rfc.section.4.2.3.p.3">A basic redirected signaling session resembles the following, as shown in <a href="#fig-redirected-signaling">Figure 11</a>:</p>
<div id="rfc.figure.11"/>
<div id="fig-redirected-signaling"/>
<pre>
        +-------------+                            +---------------+
        |             |&lt;-(1)-- signal session 1 --&gt;|               |
        |             |                            |               |
        |             |&lt;=(2)== redirect to B ======|               |
        | DOTS client |                            | DOTS server A |
        |             |X-(4)-- signal session 1 --X|               |
        |             |                            |               |
        |             |                            |               |
        +-------------+                            +---------------+
               ^
               |
              (3) signal session 2
               |
               v
        +---------------+
        | DOTS server B |
        +---------------+
</pre>
<p class="figure">Figure 11: Redirected Signaling</p>
<p/>

<ol>
  <li>Previously established signaling session 1 exists between a DOTS client and DOTS server with address A.</li>
  <li>DOTS server A sends a server signal redirecting the client to DOTS server B.</li>
  <li>If the DOTS client does not already have a separate signaling session with the redirection target, the DOTS client initiates and establishes a signaling session with DOTS server B as described above.</li>
  <li>Having redirected the DOTS client, DOTS server A ceases sending server signals. The DOTS client likewise stops sending client signals to DOTS server A. Signal session 1 is terminated.</li>
</ol>
<p id="rfc.section.4.2.3.p.5">[[EDITOR&#8217;S NOTE: we request working group feedback and discussion of the need for redirected signaling.]]</p>
<h3 id="rfc.section.4.2.4"><a href="#rfc.section.4.2.4">4.2.4.</a> <a href="#recursive-signaling" id="recursive-signaling">Recursive Signaling</a></h3>
<p id="rfc.section.4.2.4.p.1">DOTS is centered around improving the speed and efficiency of coordinated response to DDoS attacks. One scenario not yet discussed involves coordination among federated entities operating DOTS servers and mitigators.</p>
<p id="rfc.section.4.2.4.p.2">In the course of normal DOTS operations, a DOTS client communicates the need for mitigation to a DOTS server, and that server initiates mitigation on a mitigator with which the server has an established service relationship. The operator of the mitigator may in turn monitor mitigation performance and capacity, as the attack being mitigated may grow in severity beyond the mitigating entity&#8217;s capabilities.</p>
<p id="rfc.section.4.2.4.p.3">The operator of the mitigator has limited options in the event a DOTS client-requested mitigation is being overwhelmed by the severity of the attack.  Out-of-scope business or service level agreements may permit the mitigating entity to drop the mitigation and let attack traffic flow unchecked to the target, but this is only encourages attack escalation. In the case where the mitigating entity is the upstream service provider for the attack target, this may mean the mitigating entity and its other services and users continue to suffer the incidental effects of the attack.</p>
<p id="rfc.section.4.2.4.p.4">A recursive signaling model as shown in <a href="#fig-recursive-signaling">Figure 12</a> below offers an alternative. In a variation of the primary use case &#8220;Successful Automatic or Operator-Assisted CPE or PE Mitigators Request Upstream DDoS Mitigation Services&#8221; described in <a href="#I-D.ietf-dots-use-cases">[I-D.ietf-dots-use-cases]</a>, an entity operating a DOTS server and mitigation has a mitigator that is itself capable of acting as a DOTS client. The mitigator with DOTS client capabilities has an established signaling session with a DOTS server belonging to a separate administrative entity.</p>
<p id="rfc.section.4.2.4.p.5">With these preconditions in place, the operator of the mitigator being overwhelmed or otherwise performing inadequately may request mitigation for the attack target from this separate DOTS-aware entity. Such a request recurses the originating mitigation request to the secondary DOTS server, in the hope of building a cumulative mitigation against the attack:</p>
<div id="rfc.figure.12"/>
<div id="fig-recursive-signaling"/>
<pre>
                     example.net entity
                     . . . . . . . . . . . . . . . . .
                     .                               .
       +----+    A   .  +----+       +-----------+   .
       | Cc |&lt;---------&gt;| Sn |~~~~~~~| Mitigator |   .
       +----+        .  +----+       |     Mn    |   .
                     .               |   +----+  |   .
     example.com     .               +---| Cn |--+   .
        client       .                   +----+      .
                     .                     ^         .
                     . . . . . . . . . . . | . . . . .
                                           |
                                           | B
                                           |
                     . . . . . . . . . . . | . . . . .
                     .                     v         .
                     .  +-----------+    +----+      .
                     .  | Mitigator |~~~~| So |      .
                     .  |     Mo    |    +----+      .
                     .  +-----------+                .
                     .                               .
                     . . . . . . . . . . . . . . . . .
                     example.org entity
</pre>
<p class="figure">Figure 12: Recursive Signaling</p>
<p id="rfc.section.4.2.4.p.6">In <a href="#fig-recursive-signaling">Figure 12</a> above, client Cc signals a request for mitigation across inter-domain signaling session A to the DOTS server Sn belonging to the example.net entity. DOTS server Sn enables mitigation on mitigator Mn, which, acting as DOTS client Cn, has pre-existing inter-domain signaling session B with the DOTS server So belonging to the example.org entity. At any point, DOTS client Cn MAY recurse an on-going mitigation request to DOTS server So, in the expectation that mitigator Mo will be activated to aid in the defense of the attack target.</p>
<p id="rfc.section.4.2.4.p.7">Recursive signaling is opaque to the DOTS client. To maximize mitigation visibility to the DOTS client, however, the recursing entity SHOULD provide recursed mitigation feedback in signals reporting on mitigation status to the DOTS client. For example, the recursing entity&#8217;s mitigator should incorporate into mitigation status messages available metrics such as dropped packet or byte counts from the recursed mitigation.</p>
<p id="rfc.section.4.2.4.p.8">DOTS clients involved in recursive signaling MUST be able to withdraw requests for mitigation without warning or justification, per <a href="#I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</a>.</p>
<p id="rfc.section.4.2.4.p.9">Operators of recursing mitigators MAY maintain the recursed mitigation for a brief, protocol-defined period in the event the DOTS client originating the mitigation withdraws its request for help, as per the discussion of managing mitigation toggling in the operational requirements (<a href="#I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</a>).  Service or business agreements between recursing entities are not in scope for this document.</p>
<p id="rfc.section.4.2.4.p.10">[[EDITOR&#8217;S NOTE: Recursive signaling raises questions about how to authenticate and authorize the recursed request, how end-to-end signaling functions in such a scenario, and implications for operational and data privacy, as well as what level of visibility a client has into the recursed mitigation.  We ask the working group for feedback and additional discussion of these issues to help settle the way forward.]]</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#security-considerations" id="security-considerations">Security Considerations</a></h1>
<p id="rfc.section.5.p.1">TBD</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#change-log" id="change-log">Change Log</a></h1>
<p id="rfc.section.6.p.1">2016-03-18      Initial revision</p>
<h1 id="rfc.references"><a href="#rfc.references">7.</a> References</h1>
<h2 id="rfc.references.1"><a href="#rfc.references.1">7.1.</a> Normative References</h2>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
  </tbody>
</table>
<h2 id="rfc.references.2"><a href="#rfc.references.2">7.2.</a> Informative References</h2>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-dots-requirements">[I-D.ietf-dots-requirements]</b>
      </td>
      <td class="top"><a>Mortensen, A.</a>, <a>Moskowitz, R.</a> and <a>T. Reddy</a>, "<a href="http://tools.ietf.org/html/draft-ietf-dots-requirements-00">DDoS Open Threat Signaling Requirements</a>", Internet-Draft draft-ietf-dots-requirements-00, October 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D.ietf-dots-use-cases">[I-D.ietf-dots-use-cases]</b>
      </td>
      <td class="top"><a>Dobbins, R.</a>, <a>Fouant, S.</a>, <a>Migault, D.</a>, <a>Moskowitz, R.</a>, <a>Teague, N.</a> and <a>L. Xia</a>, "<a href="http://tools.ietf.org/html/draft-ietf-dots-use-cases-00">Use cases for DDoS Open Threat Signaling</a>", Internet-Draft draft-ietf-dots-use-cases-00, October 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC0768">[RFC0768]</b>
      </td>
      <td class="top"><a>Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc768">User Datagram Protocol</a>", STD 6, RFC 768, DOI 10.17487/RFC0768, August 1980.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC0793">[RFC0793]</b>
      </td>
      <td class="top"><a>Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>", STD 7, RFC 793, DOI 10.17487/RFC0793, September 1981.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC1034">[RFC1034]</b>
      </td>
      <td class="top"><a>Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>", STD 13, RFC 1034, DOI 10.17487/RFC1034, November 1987.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2782">[RFC2782]</b>
      </td>
      <td class="top"><a>Gulbrandsen, A.</a>, <a>Vixie, P.</a> and <a>L. Esibov</a>, "<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>", RFC 2782, DOI 10.17487/RFC2782, February 2000.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4271">[RFC4271]</b>
      </td>
      <td class="top"><a>Rekhter, Y.</a>, <a>Li, T.</a> and <a>S. Hares</a>, "<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>", RFC 4271, DOI 10.17487/RFC4271, January 2006.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4732">[RFC4732]</b>
      </td>
      <td class="top"><a>Handley, M.</a>, <a>Rescorla, E.</a> and <a>IAB</a>, "<a href="http://tools.ietf.org/html/rfc4732">Internet Denial-of-Service Considerations</a>", RFC 4732, DOI 10.17487/RFC4732, December 2006.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6763">[RFC6763]</b>
      </td>
      <td class="top"><a>Cheshire, S.</a> and <a>M. Krochmal</a>, "<a href="http://tools.ietf.org/html/rfc6763">DNS-Based Service Discovery</a>", RFC 6763, DOI 10.17487/RFC6763, February 2013.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Andrew Mortensen</span> 
	  <span class="n hidden">
		<span class="family-name">Mortensen</span>
	  </span>
	</span>
	<span class="org vcardline">Arbor Networks, Inc.</span>
	<span class="adr">
	  <span class="vcardline">2727 S. State St</span>

	  <span class="vcardline">
		<span class="locality">Ann Arbor, MI</span>,  
		<span class="region"></span>
		<span class="code">48104</span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:amortensen@arbor.net">amortensen@arbor.net</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Flemming Andreasen</span> 
	  <span class="n hidden">
		<span class="family-name">Andreasen</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:fandreas@cisco.com">fandreas@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tirumaleswar Reddy</span> 
	  <span class="n hidden">
		<span class="family-name">Reddy</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span class="vcardline">Cessna Business Park, Varthur Hobli</span>
<span class="vcardline">Sarjapur Marathalli Outer Ring Road</span>

	  <span class="vcardline">
		<span class="locality">Bangalore, Karnataka</span>,  
		<span class="region"></span>
		<span class="code">560103</span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tireddy@cisco.com">tireddy@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Christopher Gray</span> 
	  <span class="n hidden">
		<span class="family-name">Gray</span>
	  </span>
	</span>
	<span class="org vcardline">Comcast, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:Christopher_Gray3@cable.comcast.com">Christopher_Gray3@cable.comcast.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Rich Compton</span> 
	  <span class="n hidden">
		<span class="family-name">Compton</span>
	  </span>
	</span>
	<span class="org vcardline">Charter Communications, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:Rich.Compton@charter.com">Rich.Compton@charter.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Nik Teague</span> 
	  <span class="n hidden">
		<span class="family-name">Teague</span>
	  </span>
	</span>
	<span class="org vcardline">Verisign, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">United States</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:nteague@verisign.com">nteague@verisign.com</a></span>

  </address>
</div>

</body>
</html>
